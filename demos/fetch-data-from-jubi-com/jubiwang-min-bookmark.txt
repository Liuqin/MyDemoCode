javascript:(function()%7Bvar requestVersion=new Date().getTime();var newestUrl="http://www.jubi.com/coin/allcoin?t=0.0"+requestVersion;var financeUrl="http://www.jubi.com/ajax/user/finance?t=0.0"+requestVersion;var showDebug=false;var filterList=[""];analyze(getNewest);function analyze(A){$.getJSON(financeUrl,function(B){if($.isFunction(A)){A(B)}})}function getNewest(A){$.getJSON(newestUrl,function(F){for(var B in F){var D=B+"_balance";var E=B+"_lock";if(((A.data[D]>0||A.data[E]>0)==false)){delete F[B]}else{if((A.data[D]>0)&&(filterList.join().indexOf(B)>-1)){F[B]=null}else{F[B].balance=A.data[D]+A.data[E]}}}debugLog(F);var C=[];for(var B in F){if(F[B]){C.push(B)}}ajaxQueue(C,F,function(){F["cny_rmb"]={cnName:"RMB",currentPrice:1,buyPrice:1,balance:A.data.cny_balance};F["cny_lock"]={cnName:"冻结",currentPrice:1,buyPrice:1,balance:A.data.cny_lock};F["cny"]={cnName:"Total",currentPrice:1,buyPrice:1,balance:A.data.cny_total};showData(F)})})}function debugLog(A){if(showDebug){console.log(A)}}function showData(D){$("#table-custom-data").remove();var C=$("<table></table>");C.attr("id","table-custom-data");C.attr("style","border: 1px solid #ccc;border-collapse: collapse;");var B=$("<tr></tr>");$("<td>名称</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td></tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td></tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>买入价</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>当前价</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>数量</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>当前价值</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);B.appendTo(C);for(var A in D){if(D[A]&&(D[A].currentPrice*D[A].balance)>0.01){var B=$("<tr></tr>");$("<td>"+D[A].cnName+"</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>"+getUpDown(D[A].buyPrice,D[A].currentPrice)+"</tb>").attr("style","border: 1px solid green;color:white;").appendTo(B);$("<td>"+((D[A].currentPrice/D[A].buyPrice-1)*100).toFixed(3)+"%</tb>").attr("style","text-align:right;border: 1px solid green;color:white;").appendTo(B);$("<td>"+D[A].buyPrice.toFixed(7)+"</tb>").attr("style","text-align:right;border: 1px solid green;color:white;").appendTo(B);$("<td>"+D[A].currentPrice.toFixed(7)+"</tb>").attr("style","text-align:right;border: 1px solid green;color:white;").appendTo(B);$("<td>"+D[A].balance.toFixed(4)+"</tb>").attr("style","text-align:right;border: 1px solid green;color:white;").appendTo(B);$("<td>"+(D[A].currentPrice*D[A].balance).toFixed(3)+formatOffset((D[A].currentPrice-D[A].buyPrice)*D[A].balance)+"</tb>").attr("style","text-align:right;border: 1px solid green;color:white;").appendTo(B);B.appendTo(C);console.log("name="+D[A].cnName+", buyPrice="+D[A].buyPrice+", currentPrice="+D[A].currentPrice+", balance="+D[A].balance)}}C.prependTo($(document.body)).attr("style","position:fixed;bottom:10px;right:10px;background-color:#205081;color:white;z-index:999999;width:600px;")}function formatOffset(A){if(A>=0){return"[+"+A.toFixed(3)+"]"}else{return"["+A.toFixed(3)+"]"}}function getUpDown(A,B){if(A>B){return"↓"}else{if(A==B){return"|"}else{return"↑"}}}function ajaxQueue(E,D,A){var C=0;var B=function(F){debugLog(C+"-"+F);$.getJSON(getBuyInfoUrl(F),function(G){D[F].buyPrice=getBuyPrice(G.data.datas);D[F].cnName=D[F][0];D[F].currentPrice=D[F][1];++C;if(C<=E.length-1){setTimeout(function(){B(E[C])},100)}else{debugLog("finish.");A()}})};B(E[C])}function getBuyPrice(B){for(var A=0;A<B.length;A++){if(B[A]&&B[A].t=="买入"){return B[A].p}}return 0}function getBuyInfoUrl(A){return"http://www.jubi.com/ajax/trade/order/coin/"+A+"/type/3?p=1"};%7D)()